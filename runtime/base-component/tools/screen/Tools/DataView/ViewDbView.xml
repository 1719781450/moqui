<?xml version="1.0" encoding="UTF-8"?>
<!--
This is free and unencumbered software released into the public domain.
For specific language governing permissions and limitations refer to
the LICENSE.md file or http://unlicense.org
-->
<screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-1.5.xsd"
        default-menu-title="View DB-View" default-menu-index="1">

    <parameter name="dbViewEntityName" required="true"/>

    <transition name="edit"><default-response url="../EditDbView"/></transition>
    <transition name="filter">
        <default-response url="."/>
    </transition>
    <transition name="DbView.csv">
        <default-response url="."><parameter name="renderMode" value="csv"/>
            <parameter name="pageNoLimit" value="true"/><parameter name="lastStandalone" value="true"/></default-response>
    </transition>

    <actions>
        <entity-find-one entity-name="moqui.entity.view.DbViewEntity" value-field="fieldValues"/>
        <entity-find entity-name="${dbViewEntityName}" list="dbViewList">
            <search-form-inputs/>
        </entity-find>
    </actions>
    <widgets>
        <container>
            <link url="edit" text="Edit ${dbViewEntityName}"/>
            <link url="DbView.csv" text="Get as CSV"/>
        </container>
        <label text="Data View for: ${dbViewEntityName}" type="h2"/>
        <container-dialog id="FilterViewDialog" button-text="Filter ${ec.entity.getEntityDefinition(dbViewEntityName).getPrettyName(null, null)}">
            <form-single name="FilterDbView" transition="filter" dynamic="true">
                <auto-fields-entity entity-name="${dbViewEntityName}" field-type="find"/>
                <field name="dbViewEntityName"><default-field><hidden/></default-field></field>
                <field name="submitButton"><default-field title="Find"><submit/></default-field></field>
            </form-single>
        </container-dialog>
        <form-list name="ViewList" list="dbViewList" dynamic="true">
            <auto-fields-entity entity-name="${dbViewEntityName}" field-type="display"/>
        </form-list>
    </widgets>
</screen>
