<?xml version="1.0" encoding="UTF-8"?>
<!--
  ~ This Work is in the public domain and is provided on an "AS IS" BASIS,
  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied,
  ~ including, without limitation, any warranties or conditions of TITLE,
  ~ NON-INFRINGEMENT, MERCHANTABILITY, or FITNESS FOR A PARTICULAR PURPOSE.
  ~ You are solely responsible for determining the appropriateness of using
  ~ this Work and assume any risks associated with your use of this Work.
  ~
  ~ This Work includes contributions authored by David E. Jones, not as a
  ~ "work for hire", who hereby disclaims any copyright to the same.
  -->
<screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-1.0.xsd"
        default-menu-title="Tests" default-menu-index="9" require-authentication="false">
    <widgets>
        <link url="../Login/login" text="Login as John Doe, wrong password test">
            <parameter name="userId" value="john.doe"/>
            <parameter name="password" value="wrong"/>
        </link>
        <section name="HeaderUserInfo">
            <condition><compare field="ec.user.userId" operator="not-empty"/></condition>
            <actions>
                <set field="test1" from-field="ec.user.userId"/>
                <set field="testV" value="VALUE"/>
                <call-script>
                    test2 = ec.user.userId

                    System.out.println("================== ec.user.userId=" + ec.user.userId)
                    System.out.println("================== ec.message.messages=" + ec.message.messages)
                    System.out.println("================== ec.message.errors=" + ec.message.errors)
                    System.out.println("================== test1=" + test1)
                    System.out.println("================== test2=" + test2)
                    System.out.println("================== testV=" + testV)
                    System.out.println("================== context=" + context.toString())
                </call-script>
            </actions>
            <widgets>
                <label text="Inner section:" type="h3"/>
                <label text="Direct user: ${ec.user}" type="p"/>
                <label text="Direct userId: ${ec.user.getUserId()}" type="p"/>
                <label text="Through test1: ${test1}" type="p"/>
                <label text="Through test2: ${test2}" type="p"/>
                <label text="testV: ${testV}" type="p"/>
            </widgets>
        </section>

        <label text="Outer section:" type="h3"/>
        <label text="test1: ${context.test1}" type="p"/>
        <label text="testV: ${context.testV}" type="p"/>
        <label text="User ID: ${ec.user.userId}" type="p"/>
        <label text="User Name: ${ec.user.userAccount?.userName}" type="p"/>
        <label text="Messages: ${ec.message.messages}" type="p"/>
        <label text="Errors: ${ec.message.errors}" type="p"/>
        <label text="Context: ${context.toString().replaceAll('\n','&lt;br&gt;')}" type="p"/>
    </widgets>
</screen>
